var fs        = require('fs'),
	cssConcat = require('../lib/css-concat'),
	testPath  = './test/';

fs.readdir(testPath, function(error, files) {
	if (error) throw error;

	var inFile  = '/in/main.css',
		refFile = '/expected/main-out.css';

	files.forEach(function(file) {

		fs.stat(testPath + file, function(error, stats) {
			if (error) throw error;

			if (stats.isDirectory() && file.indexOf('.') === -1) {
				var output = cssConcat.concat(testPath + file + inFile);
				fs.readFile('./test/' + file + refFile, function(error, data) {
					if (error) throw error;

					if (data + "" === output) {
						console.log("Passed " + file + ".");
					} else {
						console.log("Failed " + file + ".");
					}
				});
			}
		});

	});

});
